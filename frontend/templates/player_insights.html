<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Player Physiological Insights & Performance Analysis</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #0f2027 0%, #203a43 50%, #2c5364 100%);
            min-height: 100vh;
            padding: 20px;
            color: #333;
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
        }

        header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 30px;
            border-radius: 10px;
            margin-bottom: 30px;
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2);
            color: white;
        }

        h1 {
            margin-bottom: 20px;
            font-size: 2.2em;
        }

        .search-container {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        input[type="text"], select {
            flex: 1;
            min-width: 200px;
            padding: 12px;
            border: none;
            border-radius: 5px;
            font-size: 1em;
            background: rgba(255, 255, 255, 0.9);
        }

        input[type="text"]:focus, select:focus {
            outline: none;
            background: white;
            box-shadow: 0 0 10px rgba(255, 255, 255, 0.3);
        }

        button {
            padding: 12px 30px;
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: 2px solid white;
            border-radius: 5px;
            font-size: 1em;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: bold;
        }

        button:hover {
            background: white;
            color: #667eea;
        }

        .main-content {
            display: grid;
            grid-template-columns: 300px 1fr;
            gap: 30px;
        }

        @media (max-width: 1200px) {
            .main-content {
                grid-template-columns: 1fr;
            }
        }

        .players-list {
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2);
            max-height: 800px;
            overflow-y: auto;
            position: sticky;
            top: 20px;
        }

        .players-list h3 {
            color: #667eea;
            margin-bottom: 15px;
            border-bottom: 2px solid #667eea;
            padding-bottom: 10px;
        }

        .player-item {
            padding: 12px;
            margin-bottom: 8px;
            background: #f5f5f5;
            border-left: 4px solid #667eea;
            cursor: pointer;
            border-radius: 5px;
            transition: all 0.3s;
        }

        .player-item:hover {
            background: #e8e8ff;
            transform: translateX(5px);
            box-shadow: 0 2px 8px rgba(102, 126, 234, 0.2);
        }

        .player-item.active {
            background: #667eea;
            color: white;
            border-left-color: #764ba2;
        }

        .player-name {
            font-weight: bold;
            margin-bottom: 3px;
        }

        .player-meta {
            font-size: 0.8em;
            color: #666;
        }

        .player-item.active .player-meta {
            color: rgba(255, 255, 255, 0.8);
        }

        .player-details {
            background: white;
            border-radius: 10px;
            padding: 30px;
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2);
            overflow-y: auto;
            max-height: 90vh;
        }

        .player-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            border-radius: 10px;
            margin-bottom: 30px;
        }

        .player-header h2 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .player-header-meta {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 20px;
            margin-top: 15px;
        }

        .header-meta-item {
            background: rgba(255, 255, 255, 0.2);
            padding: 15px;
            border-radius: 5px;
            border-left: 4px solid white;
        }

        .header-meta-label {
            font-size: 0.9em;
            opacity: 0.9;
            margin-bottom: 5px;
        }

        .header-meta-value {
            font-size: 1.2em;
            font-weight: bold;
        }

        .section {
            margin-bottom: 40px;
        }

        .section-title {
            background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 15px 20px;
            border-radius: 5px;
            margin-bottom: 20px;
            font-size: 1.3em;
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .stat-card {
            background: #f5f5f5;
            padding: 20px;
            border-radius: 8px;
            border-left: 4px solid #667eea;
            text-align: center;
        }

        .stat-label {
            color: #666;
            font-size: 0.9em;
            margin-bottom: 10px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .stat-value {
            color: #667eea;
            font-size: 1.8em;
            font-weight: bold;
        }

        .format-breakdown {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }

        .format-card {
            background: linear-gradient(135deg, #f5f5f5 0%, #fff 100%);
            border: 2px solid #667eea;
            border-radius: 8px;
            padding: 20px;
        }

        .format-title {
            color: #667eea;
            font-weight: bold;
            font-size: 1.2em;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #667eea;
        }

        .format-stat {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid #eee;
        }

        .format-stat:last-child {
            border-bottom: none;
        }

        .format-stat-label {
            color: #666;
            font-weight: 500;
        }

        .format-stat-value {
            color: #333;
            font-weight: bold;
        }

        .insights-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
        }

        .insight-card {
            background: linear-gradient(135deg, #f5f5f5 0%, #fff 100%);
            border: 2px solid #667eea;
            border-radius: 8px;
            padding: 20px;
        }

        .insight-card-title {
            color: #667eea;
            font-weight: bold;
            font-size: 1.1em;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #667eea;
        }

        .insight-item {
            margin-bottom: 15px;
        }

        .insight-label {
            color: #666;
            font-size: 0.85em;
            margin-bottom: 5px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            font-weight: 600;
        }

        .insight-value {
            color: #333;
            font-size: 1em;
            font-weight: 600;
        }

        .badge {
            display: inline-block;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.85em;
            font-weight: bold;
            margin-right: 5px;
            margin-bottom: 5px;
        }

        .badge.elite {
            background: linear-gradient(135deg, #d4af37 0%, #ffd700 100%);
            color: #333;
        }

        .badge.high {
            background: linear-gradient(135deg, #4caf50 0%, #66bb6a 100%);
            color: white;
        }

        .badge.moderate {
            background: linear-gradient(135deg, #ff9800 0%, #ffb74d 100%);
            color: white;
        }

        .badge.low {
            background: linear-gradient(135deg, #f44336 0%, #ef5350 100%);
            color: white;
        }

        .description-text {
            color: #555;
            line-height: 1.6;
            background: #f9f9f9;
            padding: 12px;
            border-radius: 5px;
            margin-top: 8px;
        }

        .performance-metrics {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 15px;
        }

        .metric-box {
            background: linear-gradient(135deg, #f5f5f5 0%, #fff 100%);
            padding: 15px;
            border-radius: 8px;
            border: 2px solid #667eea;
            text-align: center;
        }

        .metric-name {
            color: #666;
            font-size: 0.85em;
            margin-bottom: 10px;
            font-weight: 600;
        }

        .metric-value {
            color: #667eea;
            font-size: 1.5em;
            font-weight: bold;
        }

        .loading {
            text-align: center;
            padding: 80px 40px;
            color: white;
            font-size: 1.2em;
        }

        .error {
            background: #ffebee;
            color: #c62828;
            padding: 20px;
            border-radius: 5px;
            margin-bottom: 20px;
            border-left: 4px solid #c62828;
        }

        .no-player {
            text-align: center;
            padding: 80px 40px;
            color: #999;
            font-size: 1.1em;
        }

        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            border-bottom: 2px solid #e0e0e0;
        }

        .tab {
            padding: 12px 20px;
            cursor: pointer;
            color: #666;
            border-bottom: 3px solid transparent;
            transition: all 0.3s;
            font-weight: 600;
        }

        .tab:hover {
            color: #667eea;
        }

        .tab.active {
            color: #667eea;
            border-bottom-color: #667eea;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .career-status {
            background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%);
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            border-left: 4px solid #2196F3;
        }

        .career-status h4 {
            color: #1565c0;
            margin-bottom: 10px;
        }

        .status-item {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid rgba(33, 150, 243, 0.2);
        }

        .status-item:last-child {
            border-bottom: none;
        }

        .status-format {
            color: #666;
            font-weight: 500;
        }

        .status-value {
            color: #1565c0;
            font-weight: bold;
        }

        .coach-note {
            background: linear-gradient(135deg, #fff3e0 0%, #ffe0b2 100%);
            padding: 20px;
            border-radius: 8px;
            border-left: 4px solid #ff9800;
            line-height: 1.7;
            color: #555;
        }

        @media (max-width: 768px) {
            .main-content {
                grid-template-columns: 1fr;
            }

            .players-list {
                max-height: 400px;
                position: static;
                top: auto;
            }

            .player-details {
                max-height: none;
            }

            .stats-grid, .format-breakdown, .insights-grid, .performance-metrics {
                grid-template-columns: 1fr;
            }

            .player-header h2 {
                font-size: 1.8em;
            }

            .section-title {
                font-size: 1.1em;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üèè Complete Player Profile & Physiological Analysis</h1>
            <div class="search-container">
                <input type="text" id="searchInput" placeholder="Search players by name..." />
                <select id="countryFilter">
                    <option value="">All Countries</option>
                    <option value="India">India</option>
                    <option value="Australia">Australia</option>
                    <option value="England">England</option>
                    <option value="Pakistan">Pakistan</option>
                    <option value="South Africa">South Africa</option>
                    <option value="New Zealand">New Zealand</option>
                    <option value="Sri Lanka">Sri Lanka</option>
                    <option value="West Indies">West Indies</option>
                    <option value="Bangladesh">Bangladesh</option>
                    <option value="Afghanistan">Afghanistan</option>
                </select>
                <button onclick="loadPlayers()">üîç Search</button>
            </div>
        </header>

        <div class="main-content">
            <div class="players-list" id="playersList">
                <h3>Players</h3>
                <div class="loading">Loading...</div>
            </div>

            <div class="player-details" id="playerDetails">
                <div class="no-player">üëà Select a player to view complete profile and insights</div>
            </div>
        </div>
    </div>

    <script>
        let allPlayers = [];

        function loadPlayers() {
            const searchQuery = document.getElementById('searchInput').value;
            const countryFilter = document.getElementById('countryFilter').value;
            
            let url = '/api/players-with-insights?limit=300';
            if (countryFilter) {
                url += `&country=${encodeURIComponent(countryFilter)}`;
            }

            fetch(url)
                .then(response => response.json())
                .then(data => {
                    if (data.success) {
                        allPlayers = data.players;
                        
                        let filtered = allPlayers;
                        if (searchQuery) {
                            filtered = allPlayers.filter(p => 
                                p.name.toLowerCase().includes(searchQuery.toLowerCase())
                            );
                        }
                        
                        displayPlayersList(filtered);
                    } else {
                        document.getElementById('playersList').innerHTML = 
                            `<div class="error">Error: ${data.error}</div>`;
                    }
                })
                .catch(error => {
                    document.getElementById('playersList').innerHTML = 
                        `<div class="error">Error loading players: ${error.message}</div>`;
                });
        }

        function displayPlayersList(players) {
            const listDiv = document.getElementById('playersList');
            if (players.length === 0) {
                listDiv.innerHTML = '<div class="no-player">No players found</div>';
                return;
            }

            let html = '<h3>Players</h3>';
            html += players.map(player => `
                <div class="player-item" onclick="selectPlayer('${player.name.replace(/'/g, "\\'")}')">
                    <div class="player-name">${player.name}</div>
                    <div class="player-meta">
                        ${player.country} ‚Ä¢ ${player.role}
                        ${player.is_young_star === 'Yes' ? ' ‚≠ê' : ''}
                    </div>
                </div>
            `).join('');
            
            listDiv.innerHTML = html;
        }

        function selectPlayer(playerName) {
            fetch(`/api/player-insights/${encodeURIComponent(playerName)}`)
                .then(response => response.json())
                .then(data => {
                    if (data.success) {
                        displayCompletePlayerProfile(data.player);
                        
                        document.querySelectorAll('.player-item').forEach(item => {
                            item.classList.remove('active');
                        });
                        event.target.closest('.player-item').classList.add('active');
                    } else {
                        document.getElementById('playerDetails').innerHTML = 
                            `<div class="error">Error: ${data.error}</div>`;
                    }
                })
                .catch(error => {
                    document.getElementById('playerDetails').innerHTML = 
                        `<div class="error">Error loading profile: ${error.message}</div>`;
                });
        }

        function displayCompletePlayerProfile(player) {
            const detailsDiv = document.getElementById('playerDetails');
            const cs = player.career_statistics || {};
            const odi = cs.odi || {};
            const t20i = cs.t20i || {};
            const ipl = cs.ipl || {};
            const status = player.career_status || {};
            const insights = player.player_insights || {};
            const phys = insights.physiological_profile || {};
            const mech = insights.pressure_handling_mechanics || {};
            const wear = insights.wearable_tech_usage || {};
            const perf = insights.performance_prediction || {};

            let html = `
                <div class="player-header">
                    <h2>${player.player_name}</h2>
                    <div class="player-header-meta">
                        <div class="header-meta-item">
                            <div class="header-meta-label">Country</div>
                            <div class="header-meta-value">${player.country}</div>
                        </div>
                        <div class="header-meta-item">
                            <div class="header-meta-label">Age</div>
                            <div class="header-meta-value">${player.age}</div>
                        </div>
                        <div class="header-meta-item">
                            <div class="header-meta-label">Role</div>
                            <div class="header-meta-value">${player.role || 'N/A'}</div>
                        </div>
                        <div class="header-meta-item">
                            <div class="header-meta-label">Batting Style</div>
                            <div class="header-meta-value">${player.batting_style || 'N/A'}</div>
                        </div>
                        <div class="header-meta-item">
                            <div class="header-meta-label">Bowling Style</div>
                            <div class="header-meta-value">${player.bowling_style || 'N/A'}</div>
                        </div>
                        <div class="header-meta-item">
                            <div class="header-meta-label">Special Shot</div>
                            <div class="header-meta-value">${player.special_shot || 'N/A'}</div>
                        </div>
                    </div>
                </div>

                <div class="section">
                    <div class="section-title">üìä Career Status</div>
                    <div class="career-status">
                        <h4>Current Status</h4>
                        ${status.odi ? `<div class="status-item"><span class="status-format">ODI</span><span class="status-value">${status.odi}</span></div>` : ''}
                        ${status.t20i ? `<div class="status-item"><span class="status-format">T20I</span><span class="status-value">${status.t20i}</span></div>` : ''}
                        ${status.test ? `<div class="status-item"><span class="status-format">Test</span><span class="status-value">${status.test}</span></div>` : ''}
                    </div>
                </div>

                <div class="section">
                    <div class="section-title">üìà Career Statistics</div>
                    <div class="format-breakdown">
                        ${odi.matches ? `
                        <div class="format-card">
                            <div class="format-title">üèè ODI (One Day International)</div>
                            <div class="format-stat">
                                <span class="format-stat-label">Matches</span>
                                <span class="format-stat-value">${odi.matches}</span>
                            </div>
                            <div class="format-stat">
                                <span class="format-stat-label">Runs</span>
                                <span class="format-stat-value">${odi.runs || 0}</span>
                            </div>
                            <div class="format-stat">
                                <span class="format-stat-label">Average</span>
                                <span class="format-stat-value">${odi.average ? odi.average.toFixed(2) : 0}</span>
                            </div>
                            <div class="format-stat">
                                <span class="format-stat-label">Strike Rate</span>
                                <span class="format-stat-value">${odi.strike_rate ? odi.strike_rate.toFixed(2) : 0}</span>
                            </div>
                            <div class="format-stat">
                                <span class="format-stat-label">Hundreds</span>
                                <span class="format-stat-value">${odi.hundreds || 0}</span>
                            </div>
                            <div class="format-stat">
                                <span class="format-stat-label">Fifties</span>
                                <span class="format-stat-value">${odi.fifties || 0}</span>
                            </div>
                            <div class="format-stat">
                                <span class="format-stat-label">Highest Score</span>
                                <span class="format-stat-value">${odi.highest_score || 0}</span>
                            </div>
                            <div class="format-stat">
                                <span class="format-stat-label">Sixes</span>
                                <span class="format-stat-value">${odi.sixes || 0}</span>
                            </div>
                            <div class="format-stat">
                                <span class="format-stat-label">Wickets</span>
                                <span class="format-stat-value">${odi.wickets || 0}</span>
                            </div>
                            <div class="format-stat">
                                <span class="format-stat-label">Best Bowling</span>
                                <span class="format-stat-value">${odi.best_bowling || 'N/A'}</span>
                            </div>
                        </div>
                        ` : ''}

                        ${t20i.matches ? `
                        <div class="format-card">
                            <div class="format-title">‚ö° T20I (Twenty20 International)</div>
                            <div class="format-stat">
                                <span class="format-stat-label">Matches</span>
                                <span class="format-stat-value">${t20i.matches}</span>
                            </div>
                            <div class="format-stat">
                                <span class="format-stat-label">Runs</span>
                                <span class="format-stat-value">${t20i.runs || 0}</span>
                            </div>
                            <div class="format-stat">
                                <span class="format-stat-label">Average</span>
                                <span class="format-stat-value">${t20i.average ? t20i.average.toFixed(2) : 0}</span>
                            </div>
                            <div class="format-stat">
                                <span class="format-stat-label">Strike Rate</span>
                                <span class="format-stat-value">${t20i.strike_rate ? t20i.strike_rate.toFixed(2) : 0}</span>
                            </div>
                            <div class="format-stat">
                                <span class="format-stat-label">Hundreds</span>
                                <span class="format-stat-value">${t20i.hundreds || 0}</span>
                            </div>
                            <div class="format-stat">
                                <span class="format-stat-label">Fifties</span>
                                <span class="format-stat-value">${t20i.fifties || 0}</span>
                            </div>
                            <div class="format-stat">
                                <span class="format-stat-label">Highest Score</span>
                                <span class="format-stat-value">${t20i.highest_score || 0}</span>
                            </div>
                            <div class="format-stat">
                                <span class="format-stat-label">Sixes</span>
                                <span class="format-stat-value">${t20i.sixes || 0}</span>
                            </div>
                            <div class="format-stat">
                                <span class="format-stat-label">Wickets</span>
                                <span class="format-stat-value">${t20i.wickets || 0}</span>
                            </div>
                        </div>
                        ` : ''}

                        ${ipl.matches ? `
                        <div class="format-card">
                            <div class="format-title">üèüÔ∏è IPL (Indian Premier League)</div>
                            <div class="format-stat">
                                <span class="format-stat-label">Matches</span>
                                <span class="format-stat-value">${ipl.matches}</span>
                            </div>
                            <div class="format-stat">
                                <span class="format-stat-label">Runs</span>
                                <span class="format-stat-value">${ipl.runs || 0}</span>
                            </div>
                            <div class="format-stat">
                                <span class="format-stat-label">Average</span>
                                <span class="format-stat-value">${ipl.average ? ipl.average.toFixed(2) : 0}</span>
                            </div>
                            <div class="format-stat">
                                <span class="format-stat-label">Strike Rate</span>
                                <span class="format-stat-value">${ipl.strike_rate ? ipl.strike_rate.toFixed(2) : 0}</span>
                            </div>
                            <div class="format-stat">
                                <span class="format-stat-label">Hundreds</span>
                                <span class="format-stat-value">${ipl.hundreds || 0}</span>
                            </div>
                            <div class="format-stat">
                                <span class="format-stat-label">Fifties</span>
                                <span class="format-stat-value">${ipl.fifties || 0}</span>
                            </div>
                            <div class="format-stat">
                                <span class="format-stat-label">Highest Score</span>
                                <span class="format-stat-value">${ipl.highest_score || 0}</span>
                            </div>
                            <div class="format-stat">
                                <span class="format-stat-label">Sixes</span>
                                <span class="format-stat-value">${ipl.sixes || 0}</span>
                            </div>
                            <div class="format-stat">
                                <span class="format-stat-label">Wickets</span>
                                <span class="format-stat-value">${ipl.wickets || 0}</span>
                            </div>
                        </div>
                        ` : ''}
                    </div>
                </div>

                <div class="section">
                    <div class="section-title">üíì Physiological Profile</div>
                    <div class="insights-grid">
                        <div class="insight-card">
                            <div class="insight-card-title">Heart Rate Metrics</div>
                            <div class="insight-item">
                                <div class="insight-label">Resting HR (BPM)</div>
                                <div class="insight-value">${phys.resting_heart_rate_bpm || 'N/A'}</div>
                            </div>
                            <div class="insight-item">
                                <div class="insight-label">Optimal In-Game HR (BPM)</div>
                                <div class="insight-value">${phys.optimal_in_game_hr_bpm || 'N/A'}</div>
                            </div>
                        </div>

                        <div class="insight-card">
                            <div class="insight-card-title">HRV & Readiness</div>
                            <div class="insight-item">
                                <div class="insight-label">HRV Readiness Level</div>
                                <div class="insight-value">
                                    <span class="badge ${phys.hrv_readiness_level?.includes('High') ? 'elite' : phys.hrv_readiness_level?.includes('Moderate') ? 'moderate' : 'low'}">
                                        ${phys.hrv_readiness_level || 'N/A'}
                                    </span>
                                </div>
                            </div>
                            <div class="insight-item">
                                <div class="insight-label">HRV Score Range</div>
                                <div class="insight-value">${phys.hrv_score_range || 'N/A'}</div>
                            </div>
                        </div>

                        <div class="insight-card">
                            <div class="insight-card-title">Recovery & Performance</div>
                            <div class="insight-item">
                                <div class="insight-label">Recovery Speed</div>
                                <div class="insight-value">${phys.recovery_speed || 'N/A'}</div>
                            </div>
                            <div class="insight-item">
                                <div class="insight-label">Pressure Zone Performance</div>
                                <div class="insight-value">${phys.pressure_zone_performance || 'N/A'}</div>
                            </div>
                            <div class="insight-item">
                                <div class="insight-label">Stress Management</div>
                                <div class="insight-value">${phys.stress_management_technique || 'N/A'}</div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="section">
                    <div class="section-title">üß† Pressure Handling & Mental Toughness</div>
                    <div class="insights-grid">
                        <div class="insight-card">
                            <div class="insight-card-title">Mental Strength</div>
                            <div class="insight-item">
                                <div class="insight-label">Mental Toughness Rating</div>
                                <div class="insight-value">
                                    <span class="badge elite">${mech.mental_toughness_rating || 'N/A'}</span>
                                </div>
                            </div>
                            <div class="insight-item">
                                <div class="insight-label">Leadership Under Fire</div>
                                <div class="insight-value">${mech.leadership_under_fire || 'N/A'}</div>
                            </div>
                            <div class="insight-item">
                                <div class="insight-label">Routine Strength</div>
                                <div class="insight-value">${mech.routine_strength || 'N/A'}</div>
                            </div>
                        </div>

                        <div class="insight-card">
                            <div class="insight-card-title">Pressure Response</div>
                            <div class="insight-item">
                                <div class="insight-label">Situation Response</div>
                                <div class="description-text">${mech.situation_response || 'N/A'}</div>
                            </div>
                        </div>

                        <div class="insight-card">
                            <div class="insight-card-title">Clutch Performance</div>
                            <div class="insight-item">
                                <div class="insight-label">Clutch Play Style</div>
                                <div class="description-text">${mech.clutch_play_style || 'N/A'}</div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="section">
                    <div class="section-title">‚åö Wearable Technology & Monitoring</div>
                    <div class="insights-grid">
                        <div class="insight-card">
                            <div class="insight-card-title">Device & Tracking</div>
                            <div class="insight-item">
                                <div class="insight-label">Recommended Device</div>
                                <div class="insight-value">${wear.device || 'N/A'}</div>
                            </div>
                            <div class="insight-item">
                                <div class="insight-label">Daily Monitoring Metrics</div>
                                <div class="insight-value">${wear.daily_monitoring || 'N/A'}</div>
                            </div>
                            <div class="insight-item">
                                <div class="insight-label">Readiness Prediction</div>
                                <div class="description-text">${wear.readiness_prediction || 'N/A'}</div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="section">
                    <div class="section-title">üìä Performance Prediction & Risk Assessment</div>
                    <div class="performance-metrics">
                        <div class="metric-box">
                            <div class="metric-name">Big Game Probability</div>
                            <div class="metric-value">
                                <span class="badge ${perf.big_game_probability?.includes('Elite') ? 'elite' : perf.big_game_probability?.includes('High') ? 'high' : perf.big_game_probability?.includes('Good') ? 'moderate' : 'low'}">
                                    ${perf.big_game_probability?.split('(')[0].trim() || 'N/A'}
                                </span>
                            </div>
                        </div>
                        <div class="metric-box">
                            <div class="metric-name">Fatigue Risk</div>
                            <div class="metric-value">
                                <span class="badge ${perf.fatigue_risk?.includes('Low') ? 'high' : 'moderate'}">
                                    ${perf.fatigue_risk || 'N/A'}
                                </span>
                            </div>
                        </div>
                        <div class="metric-box">
                            <div class="metric-name">Injury Risk</div>
                            <div class="metric-value">
                                <span class="badge ${perf.injury_risk?.includes('Low') ? 'high' : 'moderate'}">
                                    ${perf.injury_risk || 'N/A'}
                                </span>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="section">
                    <div class="section-title">üìã Coach's Personalized Note</div>
                    <div class="coach-note">
                        ${insights.coach_note || 'No specific notes available.'}
                    </div>
                </div>
            `;

            detailsDiv.innerHTML = html;
        }

        window.addEventListener('load', loadPlayers);

        document.getElementById('searchInput').addEventListener('keyup', function() {
            clearTimeout(this.searchTimeout);
            this.searchTimeout = setTimeout(() => {
                loadPlayers();
            }, 300);
        });
    </script>
</body>
</html>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        header {
            background: rgba(255, 255, 255, 0.95);
            padding: 30px;
            border-radius: 10px;
            margin-bottom: 30px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        h1 {
            color: #667eea;
            margin-bottom: 20px;
            font-size: 2.5em;
        }

        .search-container {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        input[type="text"], select {
            flex: 1;
            min-width: 200px;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 5px;
            font-size: 1em;
            transition: border-color 0.3s;
        }

        input[type="text"]:focus, select:focus {
            outline: none;
            border-color: #667eea;
        }

        button {
            padding: 12px 30px;
            background: #667eea;
            color: white;
            border: none;
            border-radius: 5px;
            font-size: 1em;
            cursor: pointer;
            transition: background 0.3s;
        }

        button:hover {
            background: #764ba2;
        }

        .main-content {
            display: grid;
            grid-template-columns: 1fr 2fr;
            gap: 30px;
            margin-bottom: 30px;
        }

        @media (max-width: 1200px) {
            .main-content {
                grid-template-columns: 1fr;
            }
        }

        .players-list {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            max-height: 800px;
            overflow-y: auto;
        }

        .player-item {
            padding: 15px;
            margin-bottom: 10px;
            background: #f5f5f5;
            border-left: 4px solid #667eea;
            cursor: pointer;
            border-radius: 5px;
            transition: all 0.3s;
        }

        .player-item:hover {
            background: #e8e8ff;
            transform: translateX(5px);
        }

        .player-item.active {
            background: #667eea;
            color: white;
            border-left-color: #764ba2;
        }

        .player-name {
            font-weight: bold;
            margin-bottom: 5px;
        }

        .player-meta {
            font-size: 0.9em;
            color: #666;
        }

        .player-item.active .player-meta {
            color: rgba(255, 255, 255, 0.8);
        }

        .player-details {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 10px;
            padding: 30px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .player-header {
            border-bottom: 2px solid #667eea;
            padding-bottom: 20px;
            margin-bottom: 30px;
        }

        .player-header h2 {
            color: #667eea;
            margin-bottom: 10px;
        }

        .player-meta-info {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }

        .meta-item {
            background: #f5f5f5;
            padding: 10px;
            border-radius: 5px;
        }

        .meta-label {
            color: #666;
            font-size: 0.9em;
            margin-bottom: 5px;
        }

        .meta-value {
            color: #333;
            font-weight: bold;
            font-size: 1.1em;
        }

        .insights-section {
            margin-bottom: 30px;
            padding: 20px;
            background: #f9f9f9;
            border-left: 4px solid #667eea;
            border-radius: 5px;
        }

        .insights-section h3 {
            color: #667eea;
            margin-bottom: 15px;
            font-size: 1.3em;
        }

        .insight-item {
            margin-bottom: 15px;
            padding: 10px;
            background: white;
            border-radius: 5px;
        }

        .insight-label {
            color: #666;
            font-size: 0.9em;
            margin-bottom: 5px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .insight-value {
            color: #333;
            font-size: 1.1em;
            font-weight: 600;
        }

        .insight-description {
            color: #666;
            font-size: 0.95em;
            margin-top: 5px;
            line-height: 1.5;
        }

        .badge {
            display: inline-block;
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 0.85em;
            font-weight: bold;
            margin-right: 5px;
            margin-bottom: 5px;
        }

        .badge.elite {
            background: #d4af37;
            color: white;
        }

        .badge.high {
            background: #4caf50;
            color: white;
        }

        .badge.moderate {
            background: #ff9800;
            color: white;
        }

        .badge.low {
            background: #f44336;
            color: white;
        }

        .performance-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }

        .performance-card {
            background: white;
            padding: 15px;
            border-radius: 5px;
            border: 2px solid #e0e0e0;
            text-align: center;
        }

        .performance-title {
            color: #667eea;
            font-size: 0.9em;
            margin-bottom: 10px;
            text-transform: uppercase;
        }

        .performance-value {
            color: #333;
            font-size: 1.3em;
            font-weight: bold;
        }

        .loading {
            text-align: center;
            padding: 40px;
            color: #667eea;
        }

        .error {
            background: #ffebee;
            color: #c62828;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
        }

        .success {
            background: #e8f5e9;
            color: #2e7d32;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
        }

        .tabs {
            display: flex;
            gap: 10px;
            border-bottom: 2px solid #e0e0e0;
            margin-bottom: 20px;
        }

        .tab {
            padding: 10px 20px;
            cursor: pointer;
            color: #666;
            border-bottom: 3px solid transparent;
            transition: all 0.3s;
        }

        .tab.active {
            color: #667eea;
            border-bottom-color: #667eea;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .no-player {
            text-align: center;
            padding: 40px;
            color: #999;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üèè Player Physiological Insights & Performance Analysis</h1>
            <div class="search-container">
                <input type="text" id="searchInput" placeholder="Search players by name..." />
                <select id="countryFilter">
                    <option value="">All Countries</option>
                    <option value="India">India</option>
                    <option value="Australia">Australia</option>
                    <option value="England">England</option>
                    <option value="Pakistan">Pakistan</option>
                    <option value="South Africa">South Africa</option>
                    <option value="New Zealand">New Zealand</option>
                    <option value="Sri Lanka">Sri Lanka</option>
                    <option value="West Indies">West Indies</option>
                    <option value="Bangladesh">Bangladesh</option>
                    <option value="Afghanistan">Afghanistan</option>
                </select>
                <button onclick="loadPlayers()">üîç Search</button>
            </div>
        </header>

        <div class="main-content">
            <div class="players-list" id="playersList">
                <div class="loading">Loading players...</div>
            </div>

            <div class="player-details" id="playerDetails">
                <div class="no-player">Select a player to view detailed insights</div>
            </div>
        </div>
    </div>

    <script>
        let allPlayers = [];
        let selectedPlayer = null;

        // Load all players on page load
        function loadPlayers() {
            const searchQuery = document.getElementById('searchInput').value;
            const countryFilter = document.getElementById('countryFilter').value;
            
            let url = '/api/players-with-insights?limit=200';
            if (countryFilter) {
                url += `&country=${encodeURIComponent(countryFilter)}`;
            }

            fetch(url)
                .then(response => response.json())
                .then(data => {
                    if (data.success) {
                        allPlayers = data.players;
                        
                        // Filter by search query
                        let filtered = allPlayers;
                        if (searchQuery) {
                            filtered = allPlayers.filter(p => 
                                p.name.toLowerCase().includes(searchQuery.toLowerCase())
                            );
                        }
                        
                        displayPlayersList(filtered);
                    } else {
                        document.getElementById('playersList').innerHTML = 
                            `<div class="error">Error: ${data.error}</div>`;
                    }
                })
                .catch(error => {
                    document.getElementById('playersList').innerHTML = 
                        `<div class="error">Error loading players: ${error.message}</div>`;
                });
        }

        function displayPlayersList(players) {
            const listDiv = document.getElementById('playersList');
            if (players.length === 0) {
                listDiv.innerHTML = '<div class="no-player">No players found</div>';
                return;
            }

            listDiv.innerHTML = players.map(player => `
                <div class="player-item" onclick="selectPlayer('${player.name}')">
                    <div class="player-name">${player.name}</div>
                    <div class="player-meta">
                        ${player.country} ‚Ä¢ ${player.role}
                        ${player.is_young_star === 'Yes' ? ' ‚≠ê' : ''}
                    </div>
                    <div class="player-meta" style="margin-top: 8px; color: #667eea; font-size: 0.85em;">
                        <strong>Toughness:</strong> ${player.insights_summary.mental_toughness_rating || 'N/A'}
                    </div>
                </div>
            `).join('');
        }

        function selectPlayer(playerName) {
            fetch(`/api/player-insights/${encodeURIComponent(playerName)}`)
                .then(response => response.json())
                .then(data => {
                    if (data.success) {
                        selectedPlayer = data.player;
                        const insights = data.player_insights;
                        displayPlayerInsights(data.player, insights);
                        
                        // Highlight selected player
                        document.querySelectorAll('.player-item').forEach(item => {
                            item.classList.remove('active');
                        });
                        event.target.closest('.player-item').classList.add('active');
                    } else {
                        document.getElementById('playerDetails').innerHTML = 
                            `<div class="error">Error: ${data.error}</div>`;
                    }
                })
                .catch(error => {
                    document.getElementById('playerDetails').innerHTML = 
                        `<div class="error">Error loading insights: ${error.message}</div>`;
                });
        }

        function displayPlayerInsights(player, insights) {
            const detailsDiv = document.getElementById('playerDetails');
            const phys = insights.physiological_profile || {};
            const mech = insights.pressure_handling_mechanics || {};
            const wear = insights.wearable_tech_usage || {};
            const perf = insights.performance_prediction || {};
            
            let html = `
                <div class="player-header">
                    <h2>${player.name}</h2>
                    <div class="player-meta-info">
                        <div class="meta-item">
                            <div class="meta-label">Country</div>
                            <div class="meta-value">${player.country}</div>
                        </div>
                        <div class="meta-item">
                            <div class="meta-label">Age</div>
                            <div class="meta-value">${player.age}</div>
                        </div>
                        <div class="meta-item">
                            <div class="meta-label">Role</div>
                            <div class="meta-value">${player.role}</div>
                        </div>
                        <div class="meta-item">
                            <div class="meta-label">Batting Style</div>
                            <div class="meta-value">${player.batting_style || 'N/A'}</div>
                        </div>
                        <div class="meta-item">
                            <div class="meta-label">Bowling Style</div>
                            <div class="meta-value">${player.bowling_style || 'N/A'}</div>
                        </div>
                        <div class="meta-item">
                            <div class="meta-label">Special Shot</div>
                            <div class="meta-value">${player.special_shot || 'N/A'}</div>
                        </div>
                    </div>
                </div>

                <div class="insights-section">
                    <h3>üíì Physiological Profile</h3>
                    <div class="insight-item">
                        <div class="insight-label">Resting Heart Rate</div>
                        <div class="insight-value">${phys.resting_heart_rate_bpm || 'N/A'} BPM</div>
                    </div>
                    <div class="insight-item">
                        <div class="insight-label">Optimal In-Game HR</div>
                        <div class="insight-value">${phys.optimal_in_game_hr_bpm || 'N/A'} BPM</div>
                    </div>
                    <div class="insight-item">
                        <div class="insight-label">HRV Readiness Level</div>
                        <div class="insight-value">
                            <span class="badge ${phys.hrv_readiness_level?.includes('High') ? 'elite' : phys.hrv_readiness_level?.includes('Moderate') ? 'moderate' : 'low'}">
                                ${phys.hrv_readiness_level || 'N/A'}
                            </span>
                        </div>
                    </div>
                    <div class="insight-item">
                        <div class="insight-label">HRV Score Range</div>
                        <div class="insight-value">${phys.hrv_score_range || 'N/A'}</div>
                    </div>
                    <div class="insight-item">
                        <div class="insight-label">Recovery Speed</div>
                        <div class="insight-value">${phys.recovery_speed || 'N/A'}</div>
                    </div>
                    <div class="insight-item">
                        <div class="insight-label">Pressure Zone Performance</div>
                        <div class="insight-value">${phys.pressure_zone_performance || 'N/A'}</div>
                    </div>
                    <div class="insight-item">
                        <div class="insight-label">Stress Management Technique</div>
                        <div class="insight-value">${phys.stress_management_technique || 'N/A'}</div>
                    </div>
                </div>

                <div class="insights-section">
                    <h3>üß† Pressure Handling & Mental Toughness</h3>
                    <div class="insight-item">
                        <div class="insight-label">Mental Toughness Rating</div>
                        <div class="insight-value">
                            <span class="badge elite">${mech.mental_toughness_rating || 'N/A'}</span>
                        </div>
                    </div>
                    <div class="insight-item">
                        <div class="insight-label">Situation Response</div>
                        <div class="insight-description">${mech.situation_response || 'N/A'}</div>
                    </div>
                    <div class="insight-item">
                        <div class="insight-label">Clutch Play Style</div>
                        <div class="insight-description">${mech.clutch_play_style || 'N/A'}</div>
                    </div>
                    <div class="insight-item">
                        <div class="insight-label">Leadership Under Fire</div>
                        <div class="insight-value">${mech.leadership_under_fire || 'N/A'}</div>
                    </div>
                    <div class="insight-item">
                        <div class="insight-label">Routine Strength</div>
                        <div class="insight-value">${mech.routine_strength || 'N/A'}</div>
                    </div>
                </div>

                <div class="insights-section">
                    <h3>‚åö Wearable Technology Usage</h3>
                    <div class="insight-item">
                        <div class="insight-label">Device</div>
                        <div class="insight-value">${wear.device || 'N/A'}</div>
                    </div>
                    <div class="insight-item">
                        <div class="insight-label">Daily Monitoring</div>
                        <div class="insight-value">${wear.daily_monitoring || 'N/A'}</div>
                    </div>
                    <div class="insight-item">
                        <div class="insight-label">Readiness Prediction</div>
                        <div class="insight-description">${wear.readiness_prediction || 'N/A'}</div>
                    </div>
                </div>

                <div class="insights-section">
                    <h3>üìä Performance Prediction</h3>
                    <div class="performance-grid">
                        <div class="performance-card">
                            <div class="performance-title">Big Game Probability</div>
                            <div class="performance-value">
                                <span class="badge ${perf.big_game_probability?.includes('Elite') ? 'elite' : perf.big_game_probability?.includes('High') ? 'high' : 'moderate'}">
                                    ${perf.big_game_probability?.split('(')[0].trim() || 'N/A'}
                                </span>
                            </div>
                        </div>
                        <div class="performance-card">
                            <div class="performance-title">Fatigue Risk</div>
                            <div class="performance-value">
                                <span class="badge ${perf.fatigue_risk?.includes('Low') ? 'high' : perf.fatigue_risk?.includes('Moderate') ? 'moderate' : 'low'}">
                                    ${perf.fatigue_risk || 'N/A'}
                                </span>
                            </div>
                        </div>
                        <div class="performance-card">
                            <div class="performance-title">Injury Risk</div>
                            <div class="performance-value">
                                <span class="badge ${perf.injury_risk?.includes('Low') ? 'high' : perf.injury_risk?.includes('Moderate') ? 'moderate' : 'low'}">
                                    ${perf.injury_risk || 'N/A'}
                                </span>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="insights-section">
                    <h3>üìã Coach's Note</h3>
                    <div class="insight-description">${insights.coach_note || 'N/A'}</div>
                </div>
            `;

            detailsDiv.innerHTML = html;
        }

        // Load players on page load
        window.addEventListener('load', loadPlayers);

        // Add real-time search
        document.getElementById('searchInput').addEventListener('keyup', function() {
            clearTimeout(this.searchTimeout);
            this.searchTimeout = setTimeout(() => {
                loadPlayers();
            }, 300);
        });
    </script>
</body>
</html>
